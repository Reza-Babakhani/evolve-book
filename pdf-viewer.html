<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>PDF Viewer - My Evolve</title>

		<!-- PWA Manifest -->
		<link rel="manifest" href="manifest.json" />

		<!-- iOS Meta Tags -->
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta
			name="apple-mobile-web-app-status-bar-style"
			content="black-translucent"
		/>
		<meta name="apple-mobile-web-app-title" content="My Evolve" />
		<link rel="apple-touch-icon" href="images/icon.png" />

		<!-- Bootstrap CSS -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>
		<!-- Bootstrap Icons -->
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
		/>
		<!-- Vazirmatn Font -->
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css"
		/>
		<!-- Custom CSS -->
		<link rel="stylesheet" href="css/style.css" />

		<link rel="icon" href="images/favicon.ico" />

		<!-- Google tag (gtag.js) -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=G-NXL6Y6MPXE"
		></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag("js", new Date());

			gtag("config", "G-NXL6Y6MPXE");
		</script>
	</head>
	<body>
		<!-- Navigation -->
		<nav class="navbar navbar-expand-lg navbar-dark glass-navbar fixed-top">
			<div class="container">
				<a class="navbar-brand fw-bold" href="index.html">
					<i class="bi bi-book"></i> My Evolve
				</a>
				<button
					class="navbar-toggler"
					type="button"
					data-bs-toggle="collapse"
					data-bs-target="#navbarNav"
				>
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarNav">
					<ul class="navbar-nav ms-auto">
						<li class="nav-item">
							<a class="nav-link" href="index.html">Home</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<!-- Breadcrumb (Hidden for full-screen PDF viewer) -->
		<div class="breadcrumb-container d-none">
			<div class="container">
				<nav aria-label="breadcrumb">
					<ol class="breadcrumb" id="breadcrumb">
						<li class="breadcrumb-item">
							<a href="index.html">Home</a>
						</li>
						<li class="breadcrumb-item">
							<a href="#" id="breadcrumbBookLink">Book</a>
						</li>
						<li
							class="breadcrumb-item active"
							id="breadcrumbPdfName"
						>
							PDF
						</li>
					</ol>
				</nav>
			</div>
		</div>

		<!-- Main Content -->
		<main class="main-content pdf-viewer-main">
			<!-- PDF Title (Hidden, used for document title) -->
			<h1 class="d-none" id="pdfTitle">PDF Viewer</h1>

			<!-- Default PDF Viewer (iframe) -->
			<iframe
				id="pdfViewer"
				src=""
				style="width: 100%; height: 100%; border: none;"
				title="PDF Viewer"
			></iframe>
		</main>

		<!-- Bootstrap JS -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
		<!-- Custom JS -->
		<script src="js/config.js"></script>
		<script>
			// Initialize PDF viewer with default browser viewer
			document.addEventListener("DOMContentLoaded", function () {
				const urlParams = new URLSearchParams(window.location.search);
				const pdfUrl = urlParams.get("url");
				const title = urlParams.get("title") || "PDF Viewer";
				const bookId = urlParams.get("bookId");

				if (!pdfUrl) {
					window.location.href = "index.html";
					return;
				}

				// Update title
				const titleElement = document.getElementById("pdfTitle");
				if (titleElement) {
					titleElement.textContent = title;
				}
				document.title = title + " - My Evolve";

				// Update breadcrumb
				if (bookId && typeof CONFIG !== "undefined") {
					const book = CONFIG.books.find((b) => b.id === parseInt(bookId));
					if (book) {
						const breadcrumbLink = document.getElementById("breadcrumbBookLink");
						const breadcrumbPdfName = document.getElementById("breadcrumbPdfName");
						if (breadcrumbLink) {
							breadcrumbLink.textContent = book.name;
							breadcrumbLink.href = `book-details.html?id=${book.id}`;
						}
						if (breadcrumbPdfName) {
							breadcrumbPdfName.textContent = title;
						}
					}
				} else {
					const breadcrumbPdfName = document.getElementById("breadcrumbPdfName");
					if (breadcrumbPdfName) {
						breadcrumbPdfName.textContent = title;
					}
				}

				// Set PDF URL in iframe
				const pdfViewer = document.getElementById("pdfViewer");
				if (pdfViewer) {
					pdfViewer.src = pdfUrl;
				}

				// Dynamically adjust PDF viewer position based on navbar height
				const navbar = document.querySelector('.navbar');
				const pdfViewerMain = document.querySelector('.pdf-viewer-main');
				if (navbar && pdfViewerMain) {
					const navbarHeight = navbar.offsetHeight;
					pdfViewerMain.style.top = navbarHeight + 'px';
					pdfViewerMain.style.height = `calc(100vh - ${navbarHeight}px)`;
				}
			});
		</script>
	</body>
</html>
