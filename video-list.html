<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Video List - My Evolve</title>

		<!-- PWA Manifest -->
		<link rel="manifest" href="manifest.json" />

		<!-- iOS Meta Tags -->
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta
			name="apple-mobile-web-app-status-bar-style"
			content="black-translucent"
		/>
		<meta name="apple-mobile-web-app-title" content="My Evolve" />
		<link rel="apple-touch-icon" href="images/icon.png" />

		<!-- Bootstrap CSS -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>
		<!-- Bootstrap Icons -->
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
		/>
		<!-- Vazirmatn Font -->
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css"
		/>
		<!-- Custom CSS -->
		<link rel="stylesheet" href="css/style.css" />

		<link rel="icon" href="images/favicon.ico" />

		<!-- Google tag (gtag.js) -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=G-NXL6Y6MPXE"
		></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag("js", new Date());

			gtag("config", "G-NXL6Y6MPXE");
		</script>
	</head>
	<body>
		<!-- Navigation -->
		<nav class="navbar navbar-expand-lg navbar-dark glass-navbar fixed-top">
			<div class="container">
				<a class="navbar-brand fw-bold" href="index.html">
					<i class="bi bi-book"></i> My Evolve
				</a>
				<button
					class="navbar-toggler"
					type="button"
					data-bs-toggle="collapse"
					data-bs-target="#navbarNav"
				>
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarNav">
					<ul class="navbar-nav ms-auto">
						<li class="nav-item">
							<a class="nav-link" href="index.html">Home</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<!-- Breadcrumb -->
		<div class="breadcrumb-container">
			<div class="container">
				<nav aria-label="breadcrumb">
					<ol class="breadcrumb" id="breadcrumb">
						<li class="breadcrumb-item">
							<a href="index.html">Home</a>
						</li>
						<li class="breadcrumb-item">
							<a href="#" id="breadcrumbBookLink">Book</a>
						</li>
						<li class="breadcrumb-item active">Video Files</li>
					</ol>
				</nav>
			</div>
		</div>

		<!-- Main Content -->
		<main class="main-content">
			<div class="container py-5">
				<h1 class="display-5 fw-bold text-white mb-4">Video Files</h1>

				<!-- Search Box -->
				<div class="mb-4">
					<div class="input-group">
						<input
							type="text"
							id="videoSearchInput"
							class="form-control border-1 rounded-5"
							placeholder="Search video files..."
							oninput="filterVideoList()"
						/>
					</div>
				</div>

				<div id="videoList">
					<!-- Video items will be loaded here -->
				</div>
			</div>
		</main>

		<!-- Floating Refresh Button -->
		<button
			class="refresh-fab"
			onclick="refreshVideoList()"
			title="Refresh"
		>
			<i class="bi bi-arrow-clockwise"></i>
		</button>

		<!-- Bootstrap JS -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
		<!-- Custom JS -->
		<script src="js/config.js"></script>
		<script src="js/app.js"></script>
		<script>
			// Set up video list page
			document.addEventListener("DOMContentLoaded", function () {
				const urlParams = new URLSearchParams(window.location.search);
				const baseUrl = urlParams.get("baseUrl");
				const bookId = urlParams.get("bookId");

				// Update breadcrumb
				if (bookId) {
					const book = CONFIG.books.find(
						(b) => b.id === parseInt(bookId)
					);
					if (book) {
						const breadcrumbLink =
							document.getElementById("breadcrumbBookLink");
						breadcrumbLink.textContent = book.name;
						breadcrumbLink.href = `book-details.html?id=${book.id}`;
					}
				}

				if (baseUrl) {
					window.currentBook = { baseUrl: baseUrl };
					loadVideoList();
				} else {
					document.getElementById("videoList").innerHTML =
						'<div class="error-message">Invalid URL parameters</div>';
				}
			});

			function refreshVideoList() {
				loadVideoList();
			}
		</script>
	</body>
</html>
